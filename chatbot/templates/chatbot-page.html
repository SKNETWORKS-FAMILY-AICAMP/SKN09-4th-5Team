<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>{% trans "국립중앙박물관 챗봇 - MUSE" %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet">
  <!-- 정적 파일 경로 수정 -->
  <link rel="stylesheet" href="{% static 'css/chatbot.css' %}">
</head>
<body>
  <!-- 상단바 -->
  <div class="top-bar">
    <div class="logo text-start">
      <!-- 링크 수정 -->
      <a href="{% url 'landing_page' %}" target="_blank">
        <img src="{% static 'image/logo1.png' %}" alt="국립중앙박물관 로고" height="48">
      </a>
    </div>
    <div class="language-buttons">
      <button class="active" onclick="setLang(this, 'ko')">한국어</button>
      <button onclick="setLang(this, 'en')">English</button>
      <button onclick="setLang(this, 'ja')">日本語</button>
    </div>
  </div>

  <!-- 타이틀 -->
  <div class="title-box">
    <h1>{% trans "MUSE" %}</h1>
    <p>{% trans "국립중앙박물관 챗봇" %}</p>
  </div>

  <!-- 채팅창 + 입력창 포함 -->
  <div class="chat-wrapper">
    <!-- 대화 내용 -->
    <div id="chatBox" class="chat-box"></div>

    <!-- 질문 입력창 -->
    <form class="input-area" onsubmit="handleQuestion(event)">
      <div class="input-group">
        <input type="text" id="userQuestion" class="form-control" placeholder="{% trans '질문을 입력하세요' %}" required>
        <!-- 질문하기 버튼 -->
        <button id="askButton" type="submit" class="btn btn-dark">{% trans '질문하기' %}</button>
      </div>
    </form>
  </div>

  <!-- 저작권 표시 -->
  <p class="copyright">
    {% trans "©copyright 본 이미지와 자료는 국립중앙박물관으로부터 제공 받았습니다." %}
  </p>

  <!-- 자바스크립트 -->
  <script src="{% static 'js/chatbot.js' %}"></script>
  
  <script>
    // 언어 변경 함수
    function setLang(button, lang) {
      // 언어 버튼의 스타일을 변경
      const buttons = document.querySelectorAll('.language-buttons button');
      buttons.forEach(btn => btn.classList.remove('active'));
      button.classList.add('active');
      
      // 실제 언어 변경 처리 (예시: 서버에 언어 정보 보내기)
      // 여기에 실제 언어 변경 코드 추가
      // 예: window.location.href = `?lang=${lang}`;
    }

    // 질문을 처리하는 함수
    function handleQuestion(event) {
      event.preventDefault();
      const question = document.getElementById('userQuestion').value;
      
      // 예시: 질문이 비어 있지 않으면 대화창에 추가
      if(question.trim() !== "") {
        const chatBox = document.getElementById('chatBox');
        const userMessage = document.createElement('div');
        userMessage.classList.add('user-message');
        userMessage.textContent = question;
        chatBox.appendChild(userMessage);
        
        // 질문 처리 후 챗봇의 답변을 추가하는 코드 (예: 실제 챗봇 API 연동)
        const botMessage = document.createElement('div');
        botMessage.classList.add('bot-message');
        botMessage.textContent = "챗봇이 답변을 처리 중입니다.";  // 예시 답변
        chatBox.appendChild(botMessage);

        // 스크롤을 가장 아래로 이동
        chatBox.scrollTop = chatBox.scrollHeight;
        
        // 입력창 초기화
        document.getElementById('userQuestion').value = '';
      }
    }
  </script>
</body>
</html>
